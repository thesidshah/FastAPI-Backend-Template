# ============================================================================
# Application Settings
# ============================================================================
APP_ENVIRONMENT=local
APP_DEBUG=true
APP_LOG_LEVEL=DEBUG
APP_LOG_FORMAT=console
APP_API_PREFIX=/api/v1
APP_ALLOWED_HOSTS=["*"]
APP_CORS_ALLOW_ORIGINS=["http://localhost:3000"]

# ============================================================================
# Security Settings - Phase 1 (Core Security - Always Enabled)
# ============================================================================

# Rate Limiting (In-Memory)
SECURITY_RATE_LIMIT_ENABLED=true
SECURITY_RATE_LIMIT_PER_MINUTE=60
SECURITY_RATE_LIMIT_PER_HOUR=1000
SECURITY_RATE_LIMIT_BURST=10

# Content Validation
SECURITY_MAX_UPLOAD_SIZE=52428800  # 50MB in bytes
SECURITY_MAX_REQUEST_SIZE=1048576  # 1MB in bytes
SECURITY_BLOCK_NULL_BYTES=true

# Security Headers
SECURITY_ENABLE_HSTS=false  # Enable in production with HTTPS
SECURITY_ENABLE_CSP=false
SECURITY_CSP_POLICY=default-src 'self'; script-src 'self' 'unsafe-inline'

# Proxy Settings (Enable if behind nginx/CloudFlare/AWS ALB)
SECURITY_TRUST_PROXY_HEADERS=false
SECURITY_TRUSTED_PROXIES=["127.0.0.1","::1"]

# ============================================================================
# Security Settings - Phase 2 (Redis & Authentication - Optional)
# ============================================================================

# Redis for Distributed Rate Limiting
SECURITY_REDIS_ENABLED=false
SECURITY_REDIS_URL=redis://localhost:6379/0

# JWT Authentication
SECURITY_JWT_SECRET=your-secret-key-change-this-in-production-use-openssl-rand-hex-32
SECURITY_JWT_ALGORITHM=HS256
SECURITY_JWT_EXPIRY_MINUTES=60

# API Key Authentication
SECURITY_API_KEY_HEADER=X-API-Key

# ============================================================================
# Security Settings - Phase 3 (Advanced Features - Optional)
# ============================================================================

# Geo-Blocking (Requires MaxMind GeoIP2 database)
SECURITY_ENABLE_GEO_BLOCKING=false
SECURITY_GEOIP_DATABASE_PATH=/path/to/GeoLite2-Country.mmdb
SECURITY_ALLOWED_COUNTRIES=["US","CA","GB","EU"]
SECURITY_BLOCKED_COUNTRIES=[]

# Circuit Breaker
SECURITY_ENABLE_CIRCUIT_BREAKER=false
SECURITY_CIRCUIT_BREAKER_THRESHOLD=5
SECURITY_CIRCUIT_BREAKER_TIMEOUT=60

# DDoS Protection
SECURITY_ENABLE_DDOS_PROTECTION=false
SECURITY_DDOS_SYN_THRESHOLD=100
SECURITY_DDOS_RATE_THRESHOLD=1000

# ============================================================================
# Monitoring & Alerting (Phase 3 - Optional)
# ============================================================================

# Prometheus Metrics
SECURITY_ENABLE_PROMETHEUS=false

# Security Alerting
SECURITY_ENABLE_ALERTING=false
SECURITY_ALERT_RATE_LIMIT_THRESHOLD=100
SECURITY_ALERT_AUTH_FAILURE_THRESHOLD=50
